{"ast":null,"code":"import _classCallCheck from\"/opt/lampp/htdocs/Cloud/liars-ask-react-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/opt/lampp/htdocs/Cloud/liars-ask-react-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/opt/lampp/htdocs/Cloud/liars-ask-react-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/opt/lampp/htdocs/Cloud/liars-ask-react-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/opt/lampp/htdocs/Cloud/liars-ask-react-deploy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import{getSingleAnnouncement,putEditAnnouncement}from'../../controllers/announcementController';import Mde from'../editor/Mde';import Tags from'../components/Tags';import{isAuthenticated}from'../../controllers/userController';import Notify from'../components/Notify';// import ReactMarkdown from 'react-markdown';\nvar EditAcm=/*#__PURE__*/function(_React$Component){_inherits(EditAcm,_React$Component);function EditAcm(){var _this;_classCallCheck(this,EditAcm);_this=_possibleConstructorReturn(this,_getPrototypeOf(EditAcm).call(this));_this.handlePostAcm=function(){var id=_this.state.id;var token=isAuthenticated().token;var editor=document.querySelector(\"textarea.mde-text \");var body=\"\";if(editor){body=editor.value;var title=_this.state.title;var isImportant=document.getElementById(\"is-important\").checked;// tags\nvar tagsname=document.getElementById(\"tagsname\").value;var tagsnameArray=tagsname.split(\" \");tagsnameArray=tagsnameArray.filter(function(t){return t!==\"\";});if(title){if(body===\"\"){body=undefined;}putEditAnnouncement({title:title,body:body,isImportant:isImportant,tagsnameArray:tagsnameArray,id:id},token).then(function(res){console.log(res);_this.setState({message:res.message});});}}else{alert(\"Please turn to write mode\");}};_this.closeTag=function(text){var tagsname=document.getElementById(\"tagsname\");var tagsnameArray=tagsname.value.split(\" \").filter(function(t){return t!==text;});tagsname.value=tagsnameArray.join(\" \");_this.setState({tagDom:tagsname.value});};_this.handleChangeTag=function(e){if(e.keyCode===32){var tagsname=document.getElementById(\"tagsname\");var tagreplace=document.getElementById(\"tageditor-replacing-tagnames--input\");tagsname.value=tagsname.value+e.target.value;_this.setState({tagDom:tagsname.value});tagreplace.value=\"\";}};_this.handleChangeValue=function(text){_this.setState({title:text});};_this.clearMess=function(){_this.setState({message:\"\"});};_this.state={acm:{},title:\"\",body:\"\",id:\"\",isImportant:false,tagDom:\"\",message:\"\"};return _this;}_createClass(EditAcm,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;// fetching data\ngetSingleAnnouncement(this.props.match.params.acmId,isAuthenticated().user._id).then(function(res){if(!res.message){var tg=\"\";res.tags.map(function(t){return tg+=t.name+\" \";});_this2.setState({acm:res,title:res.title,body:res.body,id:res._id,isImportant:res.isImportant,tagDom:tg});document.getElementById(\"tagsname\").value=_this2.state.tagDom;if(res.isImportant){document.getElementById(\"is-important\").checked=true;}}else{_this2.props.history.push(\"/404\");}});// \nvar editor=document.querySelector(\"textarea.mde-text \");editor.setAttribute(\"id\",\"announ-content\");editor.setAttribute(\"name\",\"announ-content\");document.querySelector(\"#tageditor-replacing-tagnames--input\").addEventListener(\"keyup\",this.handleChangeTag,false);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){var tagsIncludedSize=document.querySelector(\".tags-included\").offsetWidth;document.querySelector(\"#tageditor-replacing-tagnames--input\").style.paddingLeft=tagsIncludedSize+10+\"px\";}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){document.querySelector(\"#tageditor-replacing-tagnames--input\").removeEventListener(\"keyup\",this.handleChangeTag,false);}},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,tagDom=_this$state.tagDom,message=_this$state.message,title=_this$state.title,body=_this$state.body;console.log(tagDom);return React.createElement(React.Fragment,null,React.createElement(\"div\",{id:\"mainbar\",style:{width:\"100%\"}},React.createElement(Notify,null),message!==\"\"&&React.createElement(Notify,{class:\"on\",text:message,clearMess:this.clearMess}),React.createElement(\"div\",{id:\"announ-form\"},React.createElement(\"div\",{className:\"bg-white bar-sm bs-md p16\"},React.createElement(\"div\",{className:\"post-title ps-relative mb16\"},React.createElement(\"label\",{htmlFor:\"title\",className:\"s-label mb4\"},\"Title\",React.createElement(\"p\",{className:\"s-desscription mt4\"},\"A programming language or whatever \"))),React.createElement(\"div\",{className:\"ps-relative mb16\"},React.createElement(\"input\",{id:\"title\",name:\"title\",type:\"text\",className:\"s-input w-100\",value:title,onChange:function onChange(e){return _this3.handleChangeValue(e.target.value);}})),React.createElement(\"div\",{className:\"post-editor mb16\"},React.createElement(\"div\",{className:\"ps-relative\"},React.createElement(\"label\",{htmlFor:\"announ-content\",className:\"s-label mb16 d-block\"},\"Body\",React.createElement(\"p\",{className:\"s-desscription mt4\"},\"Announcement body (all of the information about the announcement)\")),React.createElement(\"pre\",null,body),React.createElement(Mde,null),React.createElement(\"div\",{className:\"d-flex align-items-center pb12 fc-light fs-caption mt16 mb24\"},React.createElement(\"div\",{className:\"mr16\"},\"``` \",React.createElement(\"code\",{className:\"ba bc-black-9 px4 py2 bar-sm bg-black-050 fc-black-800 ff-mono\"},\"code\"),\" ```\"),React.createElement(\"div\",{className:\"mr16 fw-bold\"},\"**bold**\"),React.createElement(\"div\",{className:\"mr16 fs-italic\"},\"*italic*\"),React.createElement(\"div\",{className:\"\"},\">quote\")),React.createElement(\"div\",{className:\"ps-relative pt24\",id:\"tag-editor\"},React.createElement(\"label\",{htmlFor:\"tagsname\",className:\"s-label mb16 d-block\"},\"Tags\",React.createElement(\"p\",{className:\"s-desscription mt4\"},\"Add tags to describe what your announcement is about\")),React.createElement(\"div\",{className:\"ps-relative mb16\"},React.createElement(\"input\",{id:\"tagsname\",name:\"tagsname\",type:\"text\",className:\"s-input w-100 d-none\",placeholder:\"e.g. (javascript xml react)\"}),React.createElement(\"div\",{className:\"tags-editor ps-relative\"},React.createElement(\"span\",{className:\"tags-included ps-absolute\"},tagDom.split(\" \").map(function(tag,index){return tag!==\"\"&&React.createElement(Tags,{key:index,id:\"data-\"+tag,closeTag:function closeTag(){return _this3.closeTag(tag);},name:tag,close:true});})),React.createElement(\"input\",{type:\"text\",className:\"s-input w-100\",placeholder:\"e.g. (javascript xml react)\",id:\"tageditor-replacing-tagnames--input\",onChange:function onChange(e){return _this3.handleChangeTag(e.target.value,e.keyCode);}})))))),React.createElement(\"div\",{className:\"post-title ps-relative mb16\"},React.createElement(\"label\",{htmlFor:\"is-important\",className:\"s-label mb4\"},\"Is important\",React.createElement(\"p\",{className:\"s-desscription mt4\"},\"Is this announcement important? Check it\"))),React.createElement(\"div\",{className:\"ps-relative mb16\"},React.createElement(\"input\",{id:\"is-important\",name:\"is-important\",type:\"checkbox\",className:\"\"})),React.createElement(\"button\",{className:\"s-btn s-btn__outline s-btn__primary mt24\",onClick:this.handlePostAcm},\"Save this\")))),React.createElement(\"div\",{className:\"clear-fix\"}));}}]);return EditAcm;}(React.Component);export default EditAcm;","map":{"version":3,"sources":["/opt/lampp/htdocs/Cloud/liars-ask-react-deploy/src/admin/announcements/EditAcm.js"],"names":["React","getSingleAnnouncement","putEditAnnouncement","Mde","Tags","isAuthenticated","Notify","EditAcm","handlePostAcm","id","state","token","editor","document","querySelector","body","value","title","isImportant","getElementById","checked","tagsname","tagsnameArray","split","filter","t","undefined","then","res","console","log","setState","message","alert","closeTag","text","join","tagDom","handleChangeTag","e","keyCode","tagreplace","target","handleChangeValue","clearMess","acm","props","match","params","acmId","user","_id","tg","tags","map","name","history","push","setAttribute","addEventListener","tagsIncludedSize","offsetWidth","style","paddingLeft","removeEventListener","width","tag","index","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { getSingleAnnouncement, putEditAnnouncement } from '../../controllers/announcementController';\nimport Mde from '../editor/Mde';\nimport Tags from '../components/Tags';\nimport { isAuthenticated } from '../../controllers/userController';\nimport Notify from '../components/Notify';\n// import ReactMarkdown from 'react-markdown';\n\nclass EditAcm extends React.Component {\n    constructor() {\n        super();\n        this.state = {\n            acm: {},\n            title: \"\",\n            body: \"\",\n            id: \"\",\n            isImportant: false,\n            tagDom: \"\",\n            message: \"\",\n        }\n    }\n\n    handlePostAcm = () => {\n        let id = this.state.id;\n        let token = isAuthenticated().token;\n        let editor = document.querySelector(\"textarea.mde-text \");\n        let body = \"\";\n        if(editor) {\n            body = editor.value;\n            let title = this.state.title;\n            let isImportant = document.getElementById(\"is-important\").checked;\n            // tags\n            let tagsname = document.getElementById(\"tagsname\").value;\n            let tagsnameArray = tagsname.split(\" \")\n            tagsnameArray = tagsnameArray.filter( t => t !== \"\");\n\n            if(title) {\n                if(body === \"\") {\n                    body = undefined;\n                }\n                putEditAnnouncement({title, body, isImportant, tagsnameArray, id}, token)\n                .then( res => {\n                    console.log(res);\n                    this.setState( {message: res.message} );\n                })\n            }\n        } else {\n            alert(\"Please turn to write mode\")\n        }\n    }\n\n    closeTag = (text) => {\n        let tagsname = document.getElementById(\"tagsname\");\n        let tagsnameArray = tagsname.value.split(\" \").filter( t => t !== text);\n        tagsname.value = tagsnameArray.join(\" \");\n        this.setState( {tagDom: tagsname.value} );\n    }\n\n    handleChangeTag = (e) => {\n        if(e.keyCode === 32) {\n            let tagsname = document.getElementById(\"tagsname\");\n            let tagreplace = document.getElementById(\"tageditor-replacing-tagnames--input\")\n            tagsname.value = tagsname.value + e.target.value;\n            this.setState( {tagDom: tagsname.value} );\n            tagreplace.value = \"\";\n        }\n    }\n\n    handleChangeValue = (text) => {\n        this.setState( {title: text} );\n    }\n\n    clearMess = () => {\n        this.setState( {message: \"\"} );\n    }\n\n    componentDidMount() {\n        // fetching data\n        getSingleAnnouncement(this.props.match.params.acmId, isAuthenticated().user._id)\n        .then( res => {\n            if(!res.message) {\n                let tg = \"\";\n                res.tags.map(t => tg += t.name + \" \");\n                this.setState( {acm: res, title: res.title, body: res.body, id: res._id, isImportant: res.isImportant, tagDom: tg} );\n                document.getElementById(\"tagsname\").value = this.state.tagDom;\n                if(res.isImportant) {\n                    document.getElementById(\"is-important\").checked = true;\n                }\n            } else {\n                this.props.history.push(\"/404\");\n            }\n        })\n        // \n        let editor = document.querySelector(\"textarea.mde-text \");\n        editor.setAttribute(\"id\", \"announ-content\")\n        editor.setAttribute(\"name\", \"announ-content\")\n\n        document.querySelector(\"#tageditor-replacing-tagnames--input\").addEventListener(\"keyup\", this.handleChangeTag, false);\n    }\n    componentDidUpdate() {\n        let tagsIncludedSize = document.querySelector(\".tags-included\").offsetWidth;\n        document.querySelector(\"#tageditor-replacing-tagnames--input\").style.paddingLeft = tagsIncludedSize + 10 + \"px\";\n    }\n    componentWillUnmount() {\n        document.querySelector(\"#tageditor-replacing-tagnames--input\").removeEventListener(\"keyup\", this.handleChangeTag, false);\n    }\n\n    render() {\n        const { tagDom, message, title, body } = this.state;\n        console.log(tagDom)\n        return (\n            <>\n                <div id=\"mainbar\" style={{width: \"100%\"}}>\n                    <Notify />  \n                    {message !== \"\" &&  <Notify class=\"on\" text={message} clearMess={this.clearMess} />}\n                    <div id=\"announ-form\">\n                        <div className=\"bg-white bar-sm bs-md p16\">\n                            <div className=\"post-title ps-relative mb16\">\n                                <label htmlFor=\"title\" className=\"s-label mb4\">\n                                    Title\n                                    <p className=\"s-desscription mt4\">A programming language or whatever </p>\n                                </label>\n                            </div>\n                            <div className=\"ps-relative mb16\">\n                                <input id=\"title\" name=\"title\" type=\"text\" className=\"s-input w-100\"\n                                    value={title}\n                                    onChange={ (e) => this.handleChangeValue(e.target.value) }\n                                />\n                            </div>\n                            \n                            <div className=\"post-editor mb16\">\n                                <div className=\"ps-relative\">\n                                    <label htmlFor=\"announ-content\" className=\"s-label mb16 d-block\">\n                                        Body\n                                        <p className=\"s-desscription mt4\">Announcement body (all of the information about the announcement)</p>\n                                    </label>\n                                    {/* <ReactMarkdown source={body}/> */}\n                                    <pre>{body}</pre>\n                                    <Mde />\n                                    {/* CAPTOPN */}\n                                    <div className=\"d-flex align-items-center pb12 fc-light fs-caption mt16 mb24\">\n                                        <div className=\"mr16\">\n                                            ``` <code className=\"ba bc-black-9 px4 py2 bar-sm bg-black-050 fc-black-800 ff-mono\">code</code> ```\n                                        </div>\n                                        <div className=\"mr16 fw-bold\">\n                                            **bold**\n                                        </div>\n                                        <div className=\"mr16 fs-italic\">\n                                            *italic*\n                                        </div>\n                                        <div className=\"\">\n                                            &gt;quote\n                                        </div>\n                                    </div>\n                                    {/* TAGS EDITOR */}\n                                    <div className=\"ps-relative pt24\" id=\"tag-editor\">\n                                        <label htmlFor=\"tagsname\" className=\"s-label mb16 d-block\">\n                                            Tags\n                                            <p className=\"s-desscription mt4\">Add tags to describe what your announcement is about</p>\n                                        </label>\n                                        <div className=\"ps-relative mb16\">\n                                            <input \n                                                id=\"tagsname\" name=\"tagsname\" type=\"text\" className=\"s-input w-100 d-none\" placeholder=\"e.g. (javascript xml react)\"    \n                                            />\n                                            <div className=\"tags-editor ps-relative\" >\n                                                <span className=\"tags-included ps-absolute\">\n                                                    \n                                                    {\n                                                        tagDom.split(\" \").map( (tag, index) => {\n                                                            return tag !== \"\" && <Tags key={index} id={\"data-\" + tag} closeTag={() => this.closeTag(tag)} name={tag} close={true}/>\n                                                        })\n                                                    }\n                                                </span>\n                                            <input\n                                                type=\"text\" className=\"s-input w-100\" placeholder=\"e.g. (javascript xml react)\"\n                                                id=\"tageditor-replacing-tagnames--input\"\n                                                onChange={(e) => this.handleChangeTag(e.target.value, e.keyCode)}\n                                            />\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n    \n                            <div className=\"post-title ps-relative mb16\">\n                                <label htmlFor=\"is-important\" className=\"s-label mb4\">\n                                    Is important\n                                    <p className=\"s-desscription mt4\">Is this announcement important? Check it</p>\n                                </label>\n                            </div>\n                            <div className=\"ps-relative mb16\">\n                                <input id=\"is-important\" name=\"is-important\" type=\"checkbox\" className=\"\" />\n                            </div>\n    \n                            <button\n                                className=\"s-btn s-btn__outline s-btn__primary mt24\"\n                                onClick={this.handlePostAcm}\n                            >Save this</button>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"clear-fix\"></div>\n            </>\n        )\n    }\n}\n\nexport default EditAcm;"]},"metadata":{},"sourceType":"module"}